<div class="right_col" role="main">
    <div class="row">
        <div class="col-sm-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>IPTables</h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content" style="display: block;">
                    <!--Gonna have a tab for each iptables table there is-->
                    <div class="" role="tabpanel" data-example-id="togglable-tabs">
                        <ul id="tab_tables" class="nav nav-tabs bar_tabs" role="tablist">
                            <li role="presentation" class="chain_tab active"><a href="#content_nat" id="tab_nat" role="tab" data-toggle="tab" aria-expanded="true">NAT</a>
                            </li>
                            <li role="presentation" class="chain_tab"><a href="#content_filter" role="tab" id="tab_filter" data-toggle="tab" aria-expanded="false">FILTER</a>
                            </li>
                        </ul>
                        <div id="content_tables" class="tab-content">
                            <div role="tabpanel" class="tab-pane fade active in" id="content_nat" aria-labelledby="iptables_tab">
                                <div class="" role="tabpanel" data-example-id="togglable-tabs">
                                    <ul id="tab_chains_nat" class="nav nav-tabs bar_tabs" role="tablist">
                                        <li role="presentation" class="chain_tab active"><a href="#nat-in" id="tab_nat_in" role="tab" data-toggle="tab" aria-expanded="true">INPUT</a>
                                        </li>
                                        <li role="presentation" class="chain_tab"><a href="#nat-pre-routing" role="tab" id="tab_nat_pre-routing" data-toggle="tab" aria-expanded="false">PRE-ROUTING</a>
                                        </li>
                                        <li role="presentation" class="chain_tab"><a href="#nat-post-routing" role="tab" id="tab_nat_post-routing" data-toggle="tab" aria-expanded="false">POST-ROUTING</a>
                                        </li>
                                        <li role="presentation" class="chain_tab"><a href="#nat-out" id="tab_nat_out" role="tab" data-toggle="tab" aria-expanded="true">OUTPUT</a>
                                        </li>
                                    </ul>
                                    <div id="content_nat_chains" class="tab-content">
                                        <div role="tabpanel" class="tab-pane fade active in" id="nat-in" aria-labelledby="tab_chains_nat">
                                            <table id="datatable_nat_in" class="table table-striped dataTable no-footer" role="grid" aria-describedby="datatable_iptables">
                                                <thead>
                                                <tr>
                                                    <th>Seq. ID</th>
                                                    <th>Matched Pkts</th>
                                                    <th>IP type</th>
                                                    <th>Input Interface</th>
                                                    <th>Input IP</th>
                                                    <th>Input port</th>
                                                    <th>Output Interface</th>
                                                    <th>Output IP</th>
                                                    <th>Output port</th>
                                                    <th>Action</th>
                                                    <th>To</th>
                                                </tr>
                                                </thead>
                                                <tbody id="rows_nat_in"></tbody>
                                            </table>
                                            <div class="more_button" id="more-nat-in" style="text-align: center; width: 100%; padding: 10px; background-color: #F1F1F4">
                                                <i class="fa fa-plus fa-3x"></i>
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane fade in" id="nat-pre-routing" aria-labelledby="tab_chains_nat">
                                            <table id="datatable_nat_pre-routing" class="table table-striped dataTable no-footer" role="grid" aria-describedby="datatable_iptables">
                                                <thead>
                                                <tr>
                                                    <th>Seq. ID</th>
                                                    <th>Matched Pkts</th>
                                                    <th>IP type</th>
                                                    <th>Input Interface</th>
                                                    <th>Input IP</th>
                                                    <th>Input port</th>
                                                    <th>Output Interface</th>
                                                    <th>Output IP</th>
                                                    <th>Output port</th>
                                                    <th>Action</th>
                                                    <th>To</th>
                                                </tr>
                                                </thead>
                                                <tbody id="rows_nat_pre"></tbody>
                                            </table>
                                            <div class="more_button" id="more-nat-pre" style="text-align: center; width: 100%; padding: 10px; background-color: #F1F1F4">
                                                <i class="fa fa-plus fa-3x"></i>
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane fade in" id="nat-post-routing" aria-labelledby="tab_chains_nat">
                                            <table id="datatable_nat_post-routing" class="table table-striped dataTable no-footer" role="grid" aria-describedby="datatable_iptables">
                                                <thead>
                                                <tr>
                                                    <th>Seq. ID</th>
                                                    <th>Matched Pkts</th>
                                                    <th>IP type</th>
                                                    <th>Input Interface</th>
                                                    <th>Input IP</th>
                                                    <th>Input port</th>
                                                    <th>Output Interface</th>
                                                    <th>Output IP</th>
                                                    <th>Output port</th>
                                                    <th>Action</th>
                                                    <th>To</th>
                                                </tr>
                                                </thead>
                                                <tbody id="rows_nat_post">
                                                </tbody>
                                            </table>
                                            <div class="more_button" id="more-nat-post" style="text-align: center; width: 100%; padding: 10px; background-color: #F1F1F4">
                                                <i class="fa fa-plus fa-3x"></i>
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane fade in" id="nat-out" aria-labelledby="tab_chains_nat">
                                            <table id="datatable_nat_out" class="table table-striped dataTable no-footer" role="grid" aria-describedby="datatable_iptables">
                                                <thead>
                                                <tr>
                                                    <th>Seq. ID</th>
                                                    <th>Matched Pkts</th>
                                                    <th>IP type</th>
                                                    <th>Input Interface</th>
                                                    <th>Input IP</th>
                                                    <th>Input port</th>
                                                    <th>Output Interface</th>
                                                    <th>Output IP</th>
                                                    <th>Output port</th>
                                                    <th>Action</th>
                                                    <th>To</th>
                                                </tr>
                                                </thead>
                                                <tbody id="rows_nat_out"></tbody>
                                            </table>
                                            <div class="more_button" id="more-nat-out" style="text-align: center; width: 100%; padding: 10px; background-color: #F1F1F4">
                                                <i class="fa fa-plus fa-3x"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div role="tabpanel" class="tab-pane fade in" id="content_filter" aria-labelledby="iptables_tab">
                                <div class="" role="tabpanel" data-example-id="togglable-tabs">
                                    <ul id="tab_chains_filter" class="nav nav-tabs bar_tabs" role="tablist">
                                        <li role="presentation" class=" chain_tab active"><a href="#filter-in" id="tab_filter_in" role="tab" data-toggle="tab" aria-expanded="true">INPUT</a>
                                        </li>
                                        <li role="presentation" class="chain_tab"><a href="#filter-forward" role="tab" id="tab_filter_forward" data-toggle="tab" aria-expanded="false">PRE-ROUTING</a>
                                        </li>
                                        <li role="presentation" class="chain_tab"><a href="#filter-out" id="tab_filter_out" role="tab" data-toggle="tab" aria-expanded="true">OUTPUT</a>
                                        </li>
                                    </ul>
                                    <div id="content_filter_chains" class="tab-content">
                                        <div role="tabpanel" class="tab-pane fade active in" id="filter-in" aria-labelledby="tab_chains_nat">
                                            <table id="datatable_filter_in" class="table table-striped dataTable no-footer" role="grid" aria-describedby="datatable_iptables">
                                                <thead>
                                                <tr>
                                                    <th>Seq. ID</th>
                                                    <th>Matched Pkts</th>
                                                    <th>IP type</th>
                                                    <th>Input interface</th>
                                                    <th>Input IP</th>
                                                    <th>Input port</th>
                                                    <th>Output interface</th>
                                                    <th>Output IP</th>
                                                    <th>Output port</th>
                                                    <th>Action</th>
                                                </tr>
                                                </thead>
                                                <tbody id="rows_filter_in"></tbody>
                                            </table>
                                            <div class="more_button" id="more-filter-in" style="text-align: center; width: 100%; padding: 10px; background-color: #F1F1F4">
                                                <i class="fa fa-plus fa-3x"></i>
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane fade in" id="filter-forward" aria-labelledby="tab_chains_nat">
                                            <table id="datatable_filter_forward" class="table table-striped dataTable no-footer" role="grid" aria-describedby="datatable_iptables">
                                                <thead>
                                                <tr>
                                                    <th>Seq. ID</th>
                                                    <th>Matched Pkts</th>
                                                    <th>IP type</th>
                                                    <th>Input interface</th>
                                                    <th>Input IP</th>
                                                    <th>Input port</th>
                                                    <th>Output interface</th>
                                                    <th>Output IP</th>
                                                    <th>Output port</th>
                                                    <th>Action</th>
                                                </tr>
                                                </thead>
                                                <tbody id="rows_filter_forward"></tbody>
                                            </table>
                                            <div class="more_button" id="more-filter-forward" style="text-align: center; width: 100%; padding: 10px; background-color: #F1F1F4">
                                                <i class="fa fa-plus fa-3x"></i>
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane fade in" id="filter-out" aria-labelledby="tab_chains_nat">
                                            <table id="datatable_filter_out" class="table table-striped dataTable no-footer" role="grid" aria-describedby="datatable_iptables">
                                                <thead>
                                                <tr>
                                                    <th>Seq. ID</th>
                                                    <th>Matched Pkts</th>
                                                    <th>IP type</th>
                                                    <th>Input interface</th>
                                                    <th>Input IP</th>
                                                    <th>Input port</th>
                                                    <th>Output interface</th>
                                                    <th>Output IP</th>
                                                    <th>Output port</th>
                                                    <th>Action</th>
                                                </tr>
                                                </thead>
                                                <tbody id="rows_filter-out"></tbody>
                                            </table>
                                            <div class="more_button" id="more-filter-out" style="text-align: center; width: 100%; padding: 10px; background-color: #F1F1F4">
                                                <i class="fa fa-plus fa-3x"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--SPLITTER-->

<script type="text/javascript" id="to_eval">


    $('tbody').innerHTML = '';

    $('.collapse-link').on('click', function() {
        var $BOX_PANEL = $(this).closest('.x_panel'),
                $ICON = $(this).find('i'),
                $BOX_CONTENT = $BOX_PANEL.find('.x_content');

        // fix for some div with hardcoded fix class
        if ($BOX_PANEL.attr('style')) {
            $BOX_CONTENT.slideToggle(200, function(){
                $BOX_PANEL.removeAttr('style');
            });
        } else {
            $BOX_CONTENT.slideToggle(200);
            $BOX_PANEL.css('height', 'auto');
        }

        $ICON.toggleClass('fa-chevron-up fa-chevron-down');
    });

    var text_input_proto = document.createElement('input');
    text_input_proto.setAttribute('class', 'form-control');
    text_input_proto.setAttribute('type', 'text');

    var number_input_proto = document.createElement('input');
    number_input_proto.setAttribute('class', 'form-control');
    number_input_proto.setAttribute('type', 'number');

    function submitAdd(event) {
        console.log('I now do something');

        //obtain data from form inputs
        var inputs_wrapper = event.target.parentNode.parentNode;
        var table = event.target.getAttribute('data-data');
        var chain = event.target.getAttribute('data-option');
        var seq_id = inputs_wrapper.childNodes[0].firstElementChild.value;
        var ip_type = inputs_wrapper.childNodes[2].firstElementChild.value;
        var in_int = inputs_wrapper.childNodes[3].firstElementChild.value;
        var in_ip = inputs_wrapper.childNodes[4].firstElementChild.value;
        var in_port = inputs_wrapper.childNodes[5].firstElementChild.value;
        var out_int = inputs_wrapper.childNodes[6].firstElementChild.value;
        var out_ip = inputs_wrapper.childNodes[7].firstElementChild.value;
        var out_port = inputs_wrapper.childNodes[8].firstElementChild.value;
        var action = inputs_wrapper.childNodes[9].firstElementChild.value;


        $.ajax({
            type: "POST",
            url: '/cgi-bin/iptables.sh',
            accepts:{
                json: 'text/json'
            },
            data: {
                action: 0,
                table: table,
                chain: chain,
                num: seq_id,
                prot: ip_type,
                in: in_int,
                source: in_ip,
                spt: in_port,
                out: out_int,
                dest: out_ip,
                dpt: out_port,
                target: action
            },
            dataType: "json",

            // html retrieve call was *not* successful
            error: function(payload) {
                console.log(payload);
                console.log("could not submit pause request async");
                $.notify("Something went wrong on our side. Or ur trying really nasty things :3", "error");
            },

            // json retrieve call was successful
            //insert it on the main div. Since we just loaded the html we do not have to remove any content since its empty
            success: function(response){

                if (response.rc) {
                    $.notify('Rule successfully registered!', 'success');
                    updateChains();
                } else {
                    $.notify('Could not add the requested rule...', 'error');
                }
            },

            failure: function () {
                console.log("failure pause request mate");
                $.notify("Something went wrong on our side. Or ur trying really nasty things :3", "error");
            }
        });
    }

    function appendNatRuleForm(datatable, table, chain) {

        trow = createBasicFormRow(datatable, table, chain);

        var to = document.createElement('td');
        to.innerHTML='<input id="" class="form-control" name="to" placeholder="p.ex. 80.71.23.90:80" required="required" type="text">';
        trow.appendChild(to);

        var confirm = document.createElement('td');
        var confirm_i = document.createElement('i');
        confirm_i.setAttribute('class', 'fa fa-check green fa-2x');
        confirm_i.setAttribute('data-data', table);
        confirm_i.setAttribute('data-option', chain);
        confirm.appendChild(confirm_i);
        trow.appendChild(confirm);
        confirm.addEventListener('click', submitAdd);

        datatable.getElementsByTagName('tbody')[0].appendChild(trow);
    }

    function appendRuleForm(datatable, table, chain) {

        trow = createBasicFormRow(datatable, table, chain);

        var confirm = document.createElement('td');
        var confirm_i = document.createElement('i');
        confirm_i.setAttribute('class', 'fa fa-check green fa-2x');
        confirm_i.setAttribute('data-data', table);
        confirm_i.setAttribute('data-option', chain);
        confirm.appendChild(confirm_i);
        trow.appendChild(confirm);
        confirm.addEventListener('click', submitAdd);

        datatable.getElementsByTagName('tbody')[0].appendChild(trow);
    }


    function createBasicFormRow(datatable, table, chain){

        //<input id="" class="form-control" name="to" placeholder="p.ex. 80.71.23.90" required="required" type="text">';
        var trow = document.createElement('tr');
        var seq_id = document.createElement('td');
        seq_id.setAttribute('style', 'width: 5%');
        var pkts = seq_id.cloneNode(false);
        var seq_id_form = text_input_proto.cloneNode(true);
        seq_id_form.setAttribute('name', 'seq_id');
        console.log(datatable);
        seq_id_form.value = datatable.getElementsByTagName('tbody')[0].childNodes.length + 1;
        seq_id.appendChild(seq_id_form);
        trow.appendChild(seq_id);
        trow.appendChild(pkts);

        var prot =  document.createElement('td');
        var prot_form = text_input_proto.cloneNode(true);
        prot_form.setAttribute('name', 'prot');
        prot_form.setAttribute('placeholder', 'tcp');
        prot.appendChild(prot_form);
        trow.appendChild(prot);

        var in_int = document.createElement('td');
        var in_int_form = text_input_proto.cloneNode(true);
        in_int_form.setAttribute('name', 'in_int');
        in_int_form.setAttribute('placeholder', 'eth0');
        in_int.appendChild(in_int_form);
        trow.appendChild(in_int);

        var in_ip = document.createElement('td');
        var in_ip_form = text_input_proto.cloneNode(true);
        in_ip_form.setAttribute('name', 'in_ip');
        in_ip_form.setAttribute('placeholder', '0.0.0.0/0');
        in_ip_form.setAttribute('required', 'required');
        in_ip.appendChild(in_ip_form);
        trow.appendChild(in_ip);

        var in_port = document.createElement('td');
        var in_port_form = number_input_proto.cloneNode(true);
        in_port_form.setAttribute('name', 'in_port');
        in_port_form.setAttribute('placeholder', '80');
        in_port.appendChild(in_port_form);
        trow.appendChild(in_port);

        var out_int = document.createElement('td');
        var out_int_form = text_input_proto.cloneNode(true);
        out_int_form.setAttribute('name', 'out_int');
        out_int_form.setAttribute('placeholder', 'eth1');
        out_int.appendChild(out_int_form);
        trow.appendChild(out_int);

        var out_ip = document.createElement('td');
        var out_ip_form = text_input_proto.cloneNode(true);
        out_ip_form.setAttribute('name', 'out_ip');
        out_ip_form.setAttribute('placeholder', '0.0.0.0/0');
        out_ip_form.setAttribute('required', 'required');
        out_ip.appendChild(out_ip_form);
        trow.appendChild(out_ip);

        var out_port = document.createElement('td');
        var out_port_form = number_input_proto.cloneNode(true);
        out_port_form.setAttribute('name', 'out_port');
        out_port_form.setAttribute('placeholder', '8000');
        out_port.appendChild(out_port_form);
        trow.appendChild(out_port);

        var action = document.createElement('td');
        var action_form = text_input_proto.cloneNode(true);
        action_form.setAttribute('name', 'action');
        action_form.setAttribute('placeholder', 'drop');
        action_form.setAttribute('required', 'required');
        action.appendChild(action_form);
        trow.appendChild(action);

        return trow
    }

    function appendFormToTable(event) {

        console.log(event);

        if (event.target.tagName == 'I') {
            var table = event.target.parentNode.parentNode.firstElementChild;
        } else {
            table = event.target.parentNode.firstElementChild;
        }

        
        console.log(table);

        switch (table.id) {
            case 'datatable_nat_in':
                appendNatRuleForm(table, 'nat', 'input');
                break;
            case 'datatable_nat_pre-routing':
                appendNatRuleForm(table, 'nat', 'prerouting');
                break;
            case 'datatable_nat_out':
                appendNatRuleForm(table, 'nat', 'output');
                break;
            case 'datatable_nat_post-routing':
                appendNatRuleForm(table, 'nat', 'postrouting');
                break;

            case 'datatable_filter_in':
                appendRuleForm(table, 'filter', 'input');
                break;
            case 'datatable_filter_forward':
                appendRuleForm(table, 'filter', 'forward');
                break;
            case 'datatable_filter_out':
                appendRuleForm(table, 'filter', 'output');
                break;
        }

    }


    function executeDeleteRequest(seq_id, chain, table) {
        console.log(table + chain + table);

        $.ajax({
            type: "POST",
            url: '/cgi-bin/iptables.sh',
            accepts:{
                json: 'text/json'
            },
            data: {
                action: 1,
                table: table,
                chain: chain,
                num: seq_id
            },
            dataType: "json",

            // html retrieve call was *not* successful
            error: function(payload) {
                console.log(payload);
                console.log("could not submit pause request async");
                $.notify("Something went wrong on our side. Or ur trying really nasty things :3", "error");
            },

            // json retrieve call was successful
            //insert it on the main div. Since we just loaded the html we do not have to remove any content since its empty
            success: function(response){

                if (response.rc) {
                    $.notify('Rule successfully deleted!', 'success');
                    updateChains();
                } else {
                    $.notify('Could not delete the requested rule...', 'error');
                }
            },

            failure: function () {
                console.log("failure pause request mate");
                $.notify("Something went wrong on our side. Or ur trying really nasty things :3", "error");
            }
        });
    }

    function ruleDeleteRequest(event) {

        console.log('holita');

        var seq_id = event.target.getAttribute('data-data');
        var chain = event.target.getAttribute('data-role');
        var table = event.target.getAttribute('data-main');

        executeDeleteRequest(seq_id, chain, table);
    }

    function addCloseButton(node, num, chain, table) {

        var close = document.createElement('td');
        var i_close = document.createElement('i');
        i_close.setAttribute('id', 'close' + num);
        i_close.setAttribute('class', 'fa fa-close acl-delete');
        i_close.setAttribute('data-data', num);
        i_close.setAttribute('data-role', chain);
        i_close.setAttribute('data-main', table);
        close.appendChild(i_close);
        node.append(close);

        return node;
    }


    function updateChains() {

        $.ajax({
            type: "POST",
            url: '/cgi-bin/iptables.sh',
            accepts:{
                json: 'text/json'
            },
            context: this,
            dataType: "json",

            // html retrieve call was *not* successful
            error: function(payload) {
                console.log(payload);
                console.log("could not submit pause request async");
                $.notify("Something went wrong on our side. Or ur trying really nasty things :3", "error");
            },

            // json retrieve call was successful
            //insert it on the main div. Since we just loaded the html we do not have to remove any content since its empty
            success: function(dades){

                //load all chains
                loadChain(dades.filter.input, 'rows_filter_in');
                loadChain(dades.filter.output, 'rows_filter_out');
                loadChain(dades.filter.forward, 'rows_filter_forward');
                loadChain(dades.nat.input, 'rows_nat_in');
                loadChain(dades.nat.prerouting, 'rows_nat_pre');
                loadChain(dades.nat.postrouting, 'rows_nat_post');
                loadChain(dades.nat.output, 'rows_nat_out');
                $('.acl-delete').click(ruleDeleteRequest);

            },

            failure: function () {
                console.log("failure pause request mate");
                $.notify("Something went wrong on our side. Or ur trying really nasty things :3", "error");
            }
        })

    }

    function loadChain(rules, chain) {

        var parent_dude = document.getElementById(chain);
        while (parent_dude.firstChild) {
            parent_dude.removeChild(parent_dude.firstChild);
        }

        function appendNatRules(parent, rules, table, chain) {
            for (i = 0; i < rules.length; i++) {
                rule = rules[i];
                parent.appendChild(addCloseButton(loadNatChainRow(rule), rule.num, chain, 'nat'));
            }
        }

        function appendRules(parent, rules, table, chain) {
            for (i = 0; i < rules.length; i++) {
                rule = rules[i];
                parent.appendChild(addCloseButton(loadChainRow(rule), rule.num, chain, 'filter'));
            }
        }

        var rule;
        var i;

        switch(chain){

            case 'rows_nat_in':
                appendNatRules(parent_dude, rules, 'nat', 'input');
                break;
            case 'rows_nat_pre':
                appendNatRules(parent_dude, rules, 'nat', 'prerouting');
                break;
            case 'rows_nat_out':
                appendNatRules(parent_dude, rules, 'nat', 'output');
                break;
            case 'rows_nat_post':
                appendNatRules(parent_dude, rules, 'nat', 'postrouting');
                break;

            case 'rows_filter_in':
                appendRules(parent_dude, rules, 'filter', 'input');
                break;
            case 'rows_filter_forward':
                appendRules(parent_dude, rules, 'filter', 'forward');
                break;
            case 'rows_filter_out':
                appendRules(parent_dude, rules, 'filter', 'output');
                break;

        }

    }


    function loadNatChainRow(rule) {

        var trow = loadChainRow(rule);

        var to = document.createElement('td');
        to.innerHTML = rule.to;
        trow.appendChild(to);

        return trow;
    }


    function loadChainRow(rule){

        var trow = document.createElement('tr');
        var seq_id = document.createElement('td');
        seq_id.setAttribute('style', 'width: 5%');

        var pkts = seq_id.cloneNode(true);
        seq_id.innerHTML = rule.num;
        pkts.innerHTML = rule.pkts;
        trow.appendChild(seq_id);
        trow.appendChild(pkts);

        var prot =  document.createElement('td');
        prot.innerHTML = rule.prot;
        trow.appendChild(prot);

        var in_int = document.createElement('td');
        in_int.innerHTML = rule.in;
        trow.appendChild(in_int);
        
        var in_ip = document.createElement('td');
        in_ip.innerHTML = rule.source;
        trow.appendChild(in_ip);
        
        var in_port = document.createElement('td');
        in_port.innerHTML = rule.spt;
        trow.appendChild(in_port);

        var out_int = document.createElement('td');
        out_int.innerHTML = rule.out;
        trow.appendChild(out_int);
        
        var out_ip = document.createElement('td');
        out_ip.innerHTML = rule.destination;
        trow.appendChild(out_ip);

        var out_port = document.createElement('td');
        out_port.innerHTML = rule.dpt;
        trow.appendChild(out_port);

        var action = document.createElement('td');
        action.innerHTML = rule.target;
        trow.appendChild(action);

        return trow
    }

    loadChain(
            [{num: 1, pkts: 2, target: "drop", prot: 'tcp', in: 'eth0', out: 'eth1', source: '1.2.3.4/32', destination: '1.2.3.4/32', spt: 23, dpt: 12},
                {num: 2, pkts: 2, target: "drop", prot: 'tcp', in: 'eth0', out: 'eth1', source: '1.2.3.4/32', destination: '1.2.3.4/32', spt: 23, dpt: 12},
                {num: 3, pkts: 2, target: "drop", prot: 'tcp', in: 'eth0', out: 'eth1', source: '1.2.3.4/32', destination: '1.2.3.4/32', spt: 23, dpt: 12},
                {num: 4, pkts: 2, target: "drop", prot: 'tcp', in: 'eth0', out: 'eth1', source: '1.2.3.4/32', destination: '1.2.3.4/32', spt: 23, dpt: 12},
                {num: 5, pkts: 2, target: "drop", prot: 'tcp', in: 'eth0', out: 'eth1', source: '1.2.3.4/32', destination: '1.2.3.4/32', spt: 23, dpt: 12},
                {num: 6, pkts: 2, target: "drop", prot: 'tcp', in: 'eth0', out: 'eth1', source: '1.2.3.4/32', destination: '1.2.3.4/32', spt: 23, dpt: 12},
                {num: 7, pkts: 2, target: "drop", prot: 'tcp', in: 'eth0', out: 'eth1', source: '1.2.3.4/32', destination: '1.2.3.4/32', spt: 23, dpt: 12},
                {num: 8, pkts: 2, target: "drop", prot: 'tcp', in: 'eth0', out: 'eth1', source: '1.2.3.4/32', destination: '1.2.3.4/32', spt: 23, dpt: 12}
            ],'rows_filter_in');

    $('.acl-delete').click(ruleDeleteRequest);
    $('.chain_tab').click(updateChains);
    $('.more_button').click(appendFormToTable);
    updateChains();

    /*
     <tr>
     <td style="width: 5%;">10</td>
     <td style="width: 5%;">10</td>
     <td>tcp</td>
     <td>eth0</td>
     <td>192.168.1.23</td>
     <td>-</td>
     <td>eth1</td>
     <td>200.12.12.5</td>
     <td>-</td>
     <td>SNAT</td>
     <td>88.97.95.23</td>
     <td><i class="fa fa-close"></i></td>
     </tr>*//*
    
    <tr>
    <td style="width: 5%;">10</td>
            <td>eth0</td>
            <td>tcp</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>REJECT</td>
            <td width="20%"></td>
            <td><i class="fa fa-close"></i></td>
            </tr>*/
    

    <!-- Datatables -->
        var handleDataTableButtons = function() {
            if ($("#datatable-buttons").length) {
                $("#datatable-buttons").DataTable({
                    dom: "Bfrtip",
                    buttons: [
                        {
                            extend: "copy",
                            className: "btn-sm"
                        },
                        {
                            extend: "csv",
                            className: "btn-sm"
                        },
                        {
                            extend: "excel",
                            className: "btn-sm"
                        },
                        {
                            extend: "pdfHtml5",
                            className: "btn-sm"
                        },
                        {
                            extend: "print",
                            className: "btn-sm"
                        }
                    ],
                    responsive: true
                });
            }
        };

        TableManageButtons = function() {
            "use strict";
            return {
                init: function() {
                    handleDataTableButtons();
                }
            };
        }();

        $('#datatable_nat').dataTable();

        $('#datatable-keytable').DataTable({
            keys: true
        });

        $('#datatable-responsive').DataTable();

        $('#datatable-scroller').DataTable({
            ajax: "js/datatables/json/scroller-demo.json",
            deferRender: true,
            scrollY: 380,
            scrollCollapse: true,
            scroller: true
        });

        $('#datatable-fixed-header').DataTable({
            fixedHeader: true
        });

        var $datatable = $('#datatable-checkbox');

        $datatable.dataTable({
            'order': [[ 1, 'asc' ]],
            'columnDefs': [
                { orderable: false, targets: [0] }
            ]
        });
        $datatable.on('draw.dt', function() {
            $('input').iCheck({
                checkboxClass: 'icheckbox_flat-green'
            });
        });

        TableManageButtons.init();
    <!-- /Datatables -->

</script>